var name,status="new",fade_delay=500,infected=1,patientsTreated=0,researchLevel=0,researchBonus=0;function progressButton(e,t,a){e.prop("disabled",!0),e.find(".progress").animate({width:"100%"},t,"swing",(function(){$(this).parent().prop("disabled",!1),$(this).width("0%"),a()}))}function researchTreatment(){researchLevel+=1,$(".research_level").text(researchLevel),researchBonus=1+researchLevel/10,$(".research_bonus").fadeIn("slow"),$(".research_bonus_amount").text(researchBonus)}function treatInfected(){researchBonus<=0&&(researchBonus=1),infected-=Math.round(1*researchBonus),patientsTreated+=Math.round(1*researchBonus),$("#infected").text(infected),patientsTreated>=8&&($(".patients_treated").text(patientsTreated),$(".out_of_hand").fadeIn("slow"))}function startMain(){$(".main h1").text("Hi there, "+name+"!"),$(".main").fadeIn("slow",(function(){$(".actions").delay(300).fadeIn()}))}function increaseInfected(){infected=Math.ceil(1.025*infected),$("#infected").text(infected)}function save(){var e={status:status,name:name,infected:infected,patientsTreated:patientsTreated,researchLevel:researchLevel,researchBonus:researchBonus};localStorage.setItem("save",JSON.stringify(e))}function load(){var e=JSON.parse(localStorage.getItem("save"));void 0!==e.status&&(status=e.status),void 0!==e.name&&(name=e.name),void 0!==e.infected&&(infected=e.infected),void 0!==e.patientsTreated&&(patientsTreated=e.patientsTreated),void 0!==e.researchLevel&&(researchLevel=e.researchLevel),void 0!==e.researchBonus&&(researchBonus=e.researchBonus),$("#infected").text(infected),$(".research_level").text(researchLevel),researchBonus>1&&$(".research_bonus").show(),$(".research_bonus_amount").text(researchBonus)}function reset(){localStorage.setItem("save",JSON.stringify({status:"new",name:null,infected:1,patientsTreated:0,researchLevel:0,researchLevelProgress:0})),load()}$(document).ready((function(){load(),"new"==status?$(".start h1").fadeIn("slow",(function(){$(".data").delay(fade_delay).fadeIn("slow",(function(){$(".message p:first").delay(fade_delay).fadeIn("slow",(function(){$(".message p:last").delay(fade_delay).fadeIn("slow",(function(){$(".name").delay(fade_delay).fadeIn("slow")}))}))}))})):"start_main"==status&&startMain(),$('input[name="name"]').on("keypress",(function(e){"13"==(e.keyCode?e.keyCode:e.which)&&(name=$(this).val(),$(".start").fadeOut("slow",(function(){startMain(),status="start_main"})))})),$(".treat_infected").on("click",(function(e){e.preventDefault(),progressButton($(this),1e3,treatInfected)})),$(".research_treatment").on("click",(function(e){e.preventDefault(),progressButton($(this),3500,researchTreatment)}))})),window.setInterval((function(){increaseInfected(),save()}),1e3);